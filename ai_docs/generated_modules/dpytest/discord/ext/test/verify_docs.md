
> [!NOTE]
> Documentation auto-generated by [ai-docs.](https://github.com/connor-john/ai-docs)

Module Overview:
The provided Python module is a testing utility for verifying messages and activities in a Discord bot. It allows developers to create assertions to check if messages sent by the bot match specific criteria and if the bot's activity is set correctly. The module uses a predicate-style assertion approach, where verification builders are constructed and then asserted for the desired outcome.

Key Features:
- Verify message content, embeds, and attachments
- Check if a message contains specific content or embeds
- Ensure no message was sent
- Verify the bot's activity type, name, and URL
- Support for exact matching and partial matching of messages and activities

Installation and Setup:
1. Install the module using pip:
```
pip install discord-ext-test
```

2. Import the necessary classes and functions in your test files:
```python
from discord.ext.test import verify, VerifyMessage, VerifyActivity
```

Usage Guide:
1. Verifying Messages:
```python
# Verify message content
assert verify().message().content("Hello World!")

# Verify message embed
embed = discord.Embed(title="Test Embed")
assert verify().message().embed(embed)

# Verify message attachment
assert verify().message().attachment("path/to/file.txt")

# Verify message contains specific content
assert verify().message().contains().content("World")

# Verify no message was sent
assert verify().message().nothing()
```

2. Verifying Activities:
```python
# Verify bot activity matches exactly
activity = discord.Activity(name="Playing", type=discord.ActivityType.playing)
assert verify().activity().matches(activity)

# Verify bot activity name
assert verify().activity().name("Playing")

# Verify bot activity type
assert verify().activity().type(discord.ActivityType.listening)

# Verify bot activity URL
assert verify().activity().url("https://example.com")
```

Testing Guide:
1. Test Case: Verify message content
```python
def test_verify_message_content(bot, channel):
    await channel.send("Hello World!")
    assert verify().message().content("Hello World!")
```

2. Test Case: Verify message embed
```python
def test_verify_message_embed(bot, channel):
    embed = discord.Embed(title="Test Embed")
    await channel.send(embed=embed)
    assert verify().message().embed(embed)
```

3. Test Case: Verify message attachment
```python
def test_verify_message_attachment(bot, channel):
    with open("test_file.txt", "w") as f:
        f.write("Test Content")
    await channel.send(file=discord.File("test_file.txt"))
    assert verify().message().attachment("test_file.txt")
```

4. Test Case: Verify no message sent
```python
def test_verify_no_message(bot, channel):
    assert verify().message().nothing()
```

5. Test Case: Verify bot activity
```python
def test_verify_bot_activity(bot):
    activity = discord.Activity(name="Playing", type=discord.ActivityType.playing)
    bot.change_presence(activity=activity)
    assert verify().activity().matches(activity)
```

Testing Best Practices:
- Use pytest as the testing framework
- Use the provided `bot` and `channel` fixtures for setting up the test environment
- Create separate test cases for each verification scenario
- Use appropriate assertion methods based on the verification type
- Ensure proper cleanup of any test files or resources created during testing

Common Test Fixtures:
- `bot`: Pytest fixture that provides a Discord bot instance for testing
- `channel`: Pytest fixture that provides a Discord text channel for testing

Error Handling and Edge Cases:
- Verify that appropriate exceptions are raised when conflicting verification methods are used (e.g., `nothing()` and `content()`)
- Test cases where messages or activities do not match the expected criteria
- Verify behavior when multiple messages or embeds are sent

Integration Testing:
- Test the module with a real Discord bot and server
- Verify that the module integrates correctly with the Discord API and library

Debugging and Troubleshooting:
- Use pytest's verbose output to get detailed information about test failures
- Debug failing tests by adding breakpoints or print statements to inspect the state of the bot and sent messages
- Refer to the Discord.py documentation for troubleshooting any issues related to the Discord library

Remember:
- Always use `assert` statements to perform the actual verification
- Chain verification methods to build complex verification scenarios
- Use the `contains()` method for partial matching of content or embeds
- Use the `peek()` method to verify a message without removing it from the queue

This documentation provides an overview of the module, its usage, and testing best practices. It includes code examples for different verification scenarios and guides developers on how to effectively use the module for testing Discord bots.

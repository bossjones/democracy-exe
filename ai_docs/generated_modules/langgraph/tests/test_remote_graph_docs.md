
> [!NOTE]
> Documentation auto-generated by [ai-docs.](https://github.com/connor-john/ai-docs)

I'll create comprehensive documentation for the RemoteGraph module. Here's the structured documentation:

# RemoteGraph Module Documentation

## Module Overview
The RemoteGraph module provides functionality for interacting with remote LangGraph Cloud computational graphs. It enables both synchronous and asynchronous operations for state management, graph visualization, and execution streaming.

### Key Features
- Remote graph state management
- Graph visualization and structure retrieval
- Streaming execution results
- Configuration management
- Async and sync API support

### Dependencies
```python
from langchain_core.runnables.graph import Edge, Node
from langgraph_sdk.schema import StreamPart
from langgraph.errors import GraphInterrupt
from langgraph_sdk.client import get_client, get_sync_client
```

## Installation and Setup

```bash
pip install langgraph-sdk
```

## Usage Guide

### 1. Basic Initialization

```python
from langgraph_sdk.client import get_client, get_sync_client
from langgraph.pregel.remote import RemoteGraph

# Initialize with async client
async_client = get_client()
remote_graph = RemoteGraph("graph_id", client=async_client)

# Initialize with sync client
sync_client = get_sync_client()
remote_graph = RemoteGraph("graph_id", sync_client=sync_client)
```

### 2. Configuration Management

```python
# Create graph with initial config
remote_graph = RemoteGraph(
    "graph_id",
    config={
        "configurable": {
            "thread_id": "thread_1"
        }
    }
)

# Update configuration
new_config = {"configurable": {"new_param": "value"}}
updated_graph = remote_graph.with_config(new_config)
```

### 3. Graph State Management

```python
# Synchronous state retrieval
state = remote_graph.get_state({"configurable": {"thread_id": "thread_1"}})

# Asynchronous state retrieval
state = await remote_graph.aget_state({"configurable": {"thread_id": "thread_1"}})

# Get state history
history = remote_graph.get_state_history(
    config={"configurable": {"thread_id": "thread_1"}},
    limit=10
)
```

### 4. Streaming Execution

```python
# Stream with specific mode
for chunk in remote_graph.stream(
    {"input": "data"},
    config={"configurable": {"thread_id": "thread_1"}},
    stream_mode="values"
):
    print(chunk)

# Async streaming with subgraphs
async for chunk in remote_graph.astream(
    {"input": "data"},
    config={"configurable": {"thread_id": "thread_1"}},
    stream_mode=["updates"],
    subgraphs=True
):
    print(chunk)
```

## Testing Guide

### 1. Configuration Tests

```python
def test_with_config():
    """Test configuration merging functionality."""
    remote_pregel = RemoteGraph(
        "test_graph_id",
        config={"configurable": {"initial": "value"}}
    )

    new_config = {"configurable": {"new": "value"}}
    updated = remote_pregel.with_config(new_config)

    assert updated.config["configurable"]["initial"] == "value"
    assert updated.config["configurable"]["new"] == "value"
```

### 2. State Management Tests

```python
@pytest.mark.anyio
async def test_state_management():
    """Test async state retrieval and updates."""
    mock_client = AsyncMock()
    mock_client.threads.get_state.return_value = {
        "values": {"key": "value"},
        "next": None,
        "checkpoint": {
            "thread_id": "thread_1",
            "checkpoint_ns": "ns",
            "checkpoint_id": "id"
        }
    }

    remote_graph = RemoteGraph("test_id", client=mock_client)
    state = await remote_graph.aget_state({"configurable": {}})

    assert state.values["key"] == "value"
```

### 3. Streaming Tests

```python
@pytest.mark.anyio
async def test_streaming():
    """Test async streaming functionality."""
    mock_client = AsyncMock()
    async_iter = AsyncMock()
    async_iter.__aiter__.return_value = [
        StreamPart(event="values", data={"chunk": "data"})
    ]
    mock_client.runs.stream.return_value = async_iter

    remote_graph = RemoteGraph("test_id", client=mock_client)
    chunks = []

    async for chunk in remote_graph.astream(
        {"input": "test"},
        config={"configurable": {}},
        stream_mode="values"
    ):
        chunks.append(chunk)

    assert chunks == [{"chunk": "data"}]
```

### 4. Integration Tests

```python
@pytest.mark.integration
async def test_integration():
    """Test actual integration with LangGraph Cloud."""
    client = get_client()
    remote_graph = RemoteGraph("graph_id", client=client)

    result = await remote_graph.ainvoke(
        {"input": "test"},
        config={"configurable": {"thread_id": "test_thread"}}
    )

    assert isinstance(result, dict)
```

## Testing Best Practices

1. Mock all external service calls
2. Test both sync and async variants of methods
3. Use pytest fixtures for common test setup
4. Test error cases and edge conditions
5. Implement proper cleanup in tests
6. Use type hints consistently
7. Test configuration merging thoroughly
8. Verify streaming behavior with various modes

## Common Test Fixtures

```python
@pytest.fixture
def mock_async_client():
    """Fixture for mocked async client."""
    client = AsyncMock()
    client.runs.stream.return_value = AsyncMock()
    return client

@pytest.fixture
def mock_sync_client():
    """Fixture for mocked sync client."""
    return MagicMock()

@pytest.fixture
def remote_graph(mock_async_client):
    """Fixture for RemoteGraph instance."""
    return RemoteGraph("test_id", client=mock_async_client)
```

## Error Handling Examples

```python
def test_error_handling():
    """Test error handling scenarios."""
    remote_graph = RemoteGraph("test_id")

    with pytest.raises(ValueError):
        remote_graph.get_state(None)

    with pytest.raises(GraphInterrupt):
        for _ in remote_graph.stream(
            {"input": "test"},
            config={"configurable": {}},
            stream_mode="invalid"
        ):
            pass
```

This documentation provides a comprehensive overview of the RemoteGraph module's functionality and testing approaches. Let me know if you need any clarification or additional examples!
